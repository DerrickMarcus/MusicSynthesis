---
header: MATLAB: Music Synthesis / 陈彦旭 / ${today}
footer: ${pageNo} of ${totalPages}
---

# MATLAB 大作业一：音乐合成

> 姓名：陈彦旭
>
> 班级：无24 学号：2022010597



目录：

[TOC]

 

## 实验目的

本章将基于傅里叶级数和傅里叶变换等基础知识，应用第一篇讲授的 MATLAB 编程技术，在电子音乐合成方面做一些练习，增进对傅里叶级数的理解，并能够熟练运用 MATLAB 基本指令。



## 实验步骤

### 简单的合成音乐

（1）请根据《东方红》片断的简谱和“十二平均律”计算出该片断中各个乐音的频率，在 MATLAB 中生成幅度为 1 、抽样频率为 8kHz 的正弦信号表示这些乐音。请用 sound 函数播放每个乐音，听一听音调是否正确。最后用这一系列乐音信号拼出《东方红》片断，注意控制每个乐音持续的时间要符合节拍，用 sound 播放你合成的音乐，听起来感觉如何？

表格如下：

| 唱名 |   1    |  2   |  3   |   4    |   5    |   6    |   7    |   i    |
| :--: | :----: | :--: | :--: | :----: | :----: | :----: | :----: | :----: |
| 音名 |   F    |  G   |  A   |  (b)B  |   C    |   D    |   E    |   F    |
| 频率 | 349.23 | 392  | 440  | 466.16 | 523.25 | 587.33 | 659.25 | 698.45 |



（2）使用包络修正乐音：为了是不同音调之间有“迭接”，增强乐音的连续性。

（3）升高和降低一个八度。升高半个音阶。

（4）加谐波分量。

（5）自选音乐合成：《小星星》



### 用傅里叶级数分析音乐

（6）

（7）首先绘制出 `realwave` 和 `wave2proc` 可以发现该段乐音大致有 10 个周期，为了去除非线性谐波与噪声，可以采取分段累加求平均的方法：先将真实吉他音的采样率变为原来的 10 倍，这样每个周期内的采样点数与原来的相同。然后将这 10 段求平均（累加除10），通过 `repmat` 扩展为 10 倍，再将采样率复原为 8KHz，得到处理过后的 `wave_proc` 。
（8）

方法一：只对第一个周期内的波形做傅里叶变换。此时效果极差，很难基波和谐波分量。

方法二：对完整的波形（十个周期）做傅里叶变换。此时效果稍好，频谱呈现三角脉冲的形状。

方法三：对原波形使用 `repmat` 函数延拓 20 倍，然后做傅里叶变换。根据图像可知，频谱更加接近冲激函数，这是因为是时域波形周期性很强。

我们通过 `findpeaks` 函数找到频谱中出现的脉冲，也就是波形中包含的频率分量。取出最小的那个即为基波频率，剩下的是高次谐波。由于采样率固定为 8KHz，因此最高频率分量不超过 4KHz。

最终得到基波频率为 330.86 Hz，对应的乐音频率为 329.63 Hz。

（9） 自动分析乐曲的音调和节拍。

首先划分节拍：先对信号取平方，得到能量，然后窗函数 `barthannwin` 做卷积，得到上述波形的包络。包络中冲激发生处是每个乐音的起始位置，由于发生冲激后衰减部分较“平缓”，不利于直接检测峰值，因此对该波形做差分，然乎取正值，此时在图像中清晰可见各处峰值。再使用 `findpeaks` 函数，设定峰值的最小幅度、峰值之间的最小间隔，最终得到该段乐音的节拍大约为 0.5s。

然后分析音调：采用同样的策略，先将片段周期性重复足够多次，做傅里叶变换得到频谱。

由于该片段中频谱连续性太强，使用 `findpeaks` 函数寻找频率点误差太大，我们需要采取其他方法。为了找到基波频率，我们先在频谱中找到幅度最大的频点，以此最大值的 1/4 为阈值，向下筛选基波频率：当最大幅度频段接近该频率的整数倍时（相对误差在 0.5% 之间），我们将此频率定为基波频率。



### 基于傅里叶级数的合成音乐

（10）直接使用（7）中傅里叶变换得到的各次谐波的幅度数组，以基波频率幅度为基准归一化之后，加上各次谐波。此时播放出的声音并没有很像吉他音。



## 感想与收获









